{namespace s=Subugoe\Find\ViewHelpers}
{namespace g=Gjz18\TmplGjz\ViewHelpers}
{namespace t3jquery=Tx_T3jquery_ViewHelpers}
<t3jquery:addJQueryAndScript jsfile="EXT:find/Resources/Public/JavaScript/flot/excanvas.min.js"/>
<t3jquery:addJQueryAndScript jsfile="EXT:find/Resources/Public/JavaScript/flot/jquery.js"/>
<t3jquery:addJQueryAndScript jsfile="EXT:find/Resources/Public/JavaScript/flot/jquery.flot.js"/>
<t3jquery:addJQueryAndScript jsfile="EXT:find/Resources/Public/JavaScript/flot/jquery.flot.selection.js"/>
<t3jquery:addJQueryAndScript jsfile="EXT:find/Resources/Public/JavaScript/flot/jquery.flot.categories.js"/>
<t3jquery:addJQueryAndScript jsfile="EXT:find/Resources/Public/JavaScript/flot/jquery.flot.canvas.js"/>

<div id="tx_find-caption">
  <form class="formZssFields">
    <capts>
      Statistische Auswertung auf GJZ18-Datenbank
    </capts>
  </form>
</div>
<div id="tx_find-fieldsLeftZss">
  
  <section class="Zeitschrift-Statistik-Erschienen-Erschlossen">
    <f:alias map="{
        ErschienenErschlossen:'{g:ZssStatistikErschienenErschlossen(string:document.d003_s0, beginn:document.i011_sa, ende:document.i011_sb)}'
      }">
      <f:if condition="{ErschienenErschlossen}">
        <f:then>
          <form class="formZssFields">
            <label>
              Erschienen / Bearbeitung :
            </label>
            <output>
              <div id="erschienen-erschlossen-visualisierung">
                <![CDATA[
                  <script type="text/javascript">
                    
                    $(function () {
                      var data = [ ]]><g:strreplace search="&quot;" replace="'">{ErschienenErschlossen}</g:strreplace><![CDATA[ ];
                      $.plot($("#placeholder1"), [ data ], {
                        series: {
                          bars: {
                            show: true,
                            barWidth: 1,
                            align: "center"
                          }
                        },
                        grid: {
                          hoverable: true,
                          clickable: true
                        },
                        xaxis: {
                          mode: "categories",
                          tickLength: 0
                        },
                        yaxis: {
                          min: 0,
                          max: 1,
                          ticks: 0
                        }
                      } );
                    });
                    
                    var previousPoint = null;
                    $("#placeholder1").bind("plothover", function (event, pos, item) {
                      if (item) {
                        if (previousPoint != item.datapoint) {
                          previousPoint = item.datapoint;
                          $("#tooltip").remove();
                          showTooltip(item.pageX, item.screenY, item.series.data[item.dataIndex][0] + ': ' + item.series.data[item.dataIndex][1] + ' Einträge');
                        }
                      } else {
                        $("#tooltip").remove();
                        previousPoint = null;
                      }
                    });
                    
                    function showTooltip(x, y, contents) {
                      $('<div id=\"tooltip\">' + contents + '<\/div>').css( {
                        position: 'absolute',
                        display: 'none',
                        top: 0,
                        left: x,
                        border: '1px solid #fdd',
                        padding: '2px',
                        'background-color': '#fee',
                        opacity: 0.80
                      }).appendTo("#erschienen-erschlossen-visualisierung-container").fadeIn(0);
                    }
                    
                  </script>
                ]]>
                <div class="erschienen-erschlossen-visualisierung-container" id="erschienen-erschlossen-visualisierung-container">
                  <div id="placeholder1" class="erschienen-erschlossen-visualisierung-placeholder"></div>
                </div>
              </div>
            </output>
          </form>
        </f:then>
      </f:if>
    </f:alias>
  </section>
  
  <section class="Zeitschrift-Statistik-Systemstellen">
    <f:alias map="{
        systemstellen:'{g:ZssStatistikSystemstellen(string:document.d003_s0)}'
      }">
      <f:if condition="{systemstellen}">
        <f:then>
          <form class="formZssFields">
            <label>
              häufigste Systemstellen :
            </label>
            <output>
              <ul style="margin-bottom:0px;">
                <f:alias map="{
                    systemstellenPfad:'{g:ZssStatistikSystemstellenPfad(array:systemstellen)}',
                    systemstellenAnzahl:'{g:ZssStatistikSystemstellenAnzahl(array:systemstellen)}'
                  }">
                  <f:for each="{systemstellenPfad}" as="valueSystemstellenPfad" iteration="iteratorSystemstellen">
                    <li style="padding:0px 0px 7px 0px;">
                      <f:translate key="LLL:{settings.languageRootPath}locallang-facets-classificationpath.xml:facet.Systemstellen.{valueSystemstellenPfad}" default="{valueSystemstellenPfad}"/>
                      <ul style="margin-bottom:0px; padding:0px 0px 7px 4px;" type="circle">
                        <li>Notation: <f:translate key="LLL:{settings.languageRootPath}locallang-facets.xml:facet.Systemstellen.{valueSystemstellenPfad}" default="{valueSystemstellenPfad}"/></li>
                        <li>Häufigkeit: {s:data.valueForKey(array:systemstellenAnzahl, key:iteratorSystemstellen.index)}</li>
                      </ul>
                    </li>
                  </f:for>
                </f:alias>
              </ul>
            </output>
          </form>
          <form class="formZssFields">
            <label>
              Fächerverteilung :
            </label>
            <output>
              <f:alias map="{
                  fach:'{g:ZssStatistikSystemstellenFaecher(string:document.d003_s0, decision:0)}',
                  faecherStatistik:'{g:ZssStatistikSystemstellenFaecher(string:document.d003_s0, decision:1)}',
                  faecherStatistikVisualisierung:'{g:ZssStatistikSystemstellenFaecher(string:document.d003_s0, decision:2)}'
                }">
<f:comment>
                <f:for each="{fach}" as="valueFach" iteration="iteratorFach">
                  {valueFach} : {s:data.valueForKey(array:faecherStatistik, key:iteratorFach.index)}{f:if(condition:"{iteratorFach.isLast}==0", then:"<br />")}
                </f:for>
</f:comment>
                <div id="systemstellen-verteilung-visualisierung">
                  <![CDATA[
                    <script type="text/javascript">
                      $(function() {
                        var data = [ ]]><g:strreplace search="&quot;" replace="'">{faecherStatistikVisualisierung}</g:strreplace><![CDATA[ ];
                        $.plot("#placeholder", [ data ], {
                          series: {
                            bars: {
                              show: true,
                              barWidth: 0.8,
                              align: "center"
                            }
                          },
                          xaxis: {
                            mode: "categories",
                            tickLength: 0
                          }
                        });
                      });
                    </script>
                  ]]>
                  <div class="systemstellen-visualisierung-container">
                    <div id="placeholder" class="systemstellen-visualisierung-placeholder"></div>
                  </div>
                </div>
  <f:comment>
  ###für Digramm###
                {faecherStatistik}
  </f:comment>
              </f:alias>
            </output>
          </form>
        </f:then>
      </f:if>
    </f:alias>
  </section>
  
</div>
